<?php

require_once '../include/db.inc.php';

$stmt = $conn->prepare("SELECT COUNT(*) AS vul_count FROM vulnerability");
$stmt->execute();
$vul_count = $stmt->get_result()->fetch_assoc()['vul_count'];

$items_per_page = 50;
$page_count = (int)(($vul_count + $items_per_page - 1) / $items_per_page);
$current_page = 1;
if (isset($_GET['page'])) {
  $current_page = $_GET['page'];
}

$stmt = $conn->prepare("SELECT id, title FROM vulnerability LIMIT ? OFFSET ?");
$stmt->bind_param("ii", $limit, $offset);
$limit = $items_per_page;
$offset = ($current_page - 1) * $items_per_page;
$stmt->execute();
$result = $stmt->get_result();

include './vulnerabilitylist.html.php';