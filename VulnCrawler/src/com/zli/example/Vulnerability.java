package com.zli.example;

import java.util.List;

public class Vulnerability
{
    private String title;
    private String description;
    private String date;
    private List<CVE> cves;
    
    public Vulnerability(String title, String description, String date) {
        this.title = title;
        this.description = description;
        this.date = date;
    }

    public void setCves(List<CVE> cves) {
        this.cves = cves;
    }

    public void insertDatabase() {
        title = title.replaceAll("\"", "\\\"");
        String sql = "INSERT INTO vulnerability (title, description, date) VALUES (\"" + 
                HtmlParser.clean(title) + "\", \"" + HtmlParser.clean(description) + "\", \"" +
                HtmlParser.clean(date) + "\");";
        Database database = new Database();
        int id = database.executeSQL(sql);
        for (int i = 0; i < cves.size(); i++) {
            cves.get(i).insertDatabase(id);
        }
    }
    
    public void updateCVE() {
        for (int i = 0; i < cves.size(); i++) {
            cves.get(i).update();
        }
    }
    
    public void print() {
        cves.get(0).print();
    }
}
